# Personalization Dataset Collection

Working on large-scale longitudinal chatbot personalization data collection.  This project requires IRB approval.

## Ongoing Objectives
[0] Finalize Firestore DB creation with IRB-aware secure defaults: user is currently on the GCP Console (project: SALTPersonal) Firestore 'Create database' page. Security rules currently set to 'Restrictive' and Location set to Multi-region (nam5). Prepare a short IRB/data-sensitivity checklist (e.g., additional encryption options, IAM least-privilege, access & audit logging, data retention policy, and required IRB approvals) and validate these settings before pressing 'Create Database'. (confidence: 7)
[1] Prepare IRB meeting packet for 'Review IRB' meeting on 2025-10-17 10:45 (calendar event confirmed): Create a 5–8 slide deck covering objectives, methodology, participant protections/consent plan, current results/metrics, open questions, and next steps; a one-page executive summary; a checklist of documents to bring; and a short 3–5 minute speaking script. (link slides and summary here once drafted) (confidence: 8)
[2] Implement Firestore session-management integration: add concrete Python implementations and wiring for key session APIs (e.g., create_session — create a session document; subscribe_to_session — listen for updates/results; upload_csv_for_session — store uploaded CSV to Cloud Storage or Firestore and link to session; get_session_results — aggregate/paginate results). Integrate changes into existing helpers (GUM/db_utils.py and CLI: GeneralUserModels/gum/cli.py) and provide a runnable local demo that authenticates with developer/service-account credentials (or emulator) showing session creation, CSV upload, and result retrieval. Include minimal tests or smoke-run instructions and a short README snippet showing how to run the demo. (confidence: 4)
[3] Repair Firebase local configuration & restore dev auth: fix NEXT_PUBLIC_FB_STORAGE_BUCKET in autometrics-site/.env.local to the actual bucket name (e.g., saltpersonal.appspot.com), enable Anonymous Auth in Firebase Console, confirm Firestore is enabled in the saltpersonal project, restart the dev server and verify signInAnonymously logs a UID (not null). Add a small "firebase:check" npm script / dev-time diagnostics in autometrics-site/firebase.ts to validate env vars, auth, and a simple Firestore read on startup (development only), and update README/.env checklist. (confidence: 6)
[4] Draft ARC Slack reply + short/expanded variants and follow-up checklist: Create a short (1–2 paragraph) and an expanded message for the open SALT DM asking ARC-specific clarifying questions (what resources they provide, whether SALT lab / named collaborators will be mentioned, expected deliverables/time commitments, support available for reproducing results, and promotion/hosting details for codeclash). Include a 3–5 bullet checklist of immediate questions to send to ARC, a 1–2 line thread summary, and 1–2 suggested follow‑up questions. Save drafts as markdown at GeneralUserModels/gum/docs/slack_messages/arc_review.md (or a local note if the repo location is unavailable). (confidence: 7)
[5] Draft explicit participant-facing consent wording that clearly states the intent to publicly release individual survey responses and chatbot interactions. Include: (a) plain-language explanation of what 'public release' means, (b) how data will be anonymized and any residual re-identification risks, (c) timeline for release and participants' ability to withdraw before release, and (d) a short FAQ addressing likely participant questions. Save the draft directly to the open IRB Google Doc (and copy into repo docs/irb_packet if the GeneralUserModels/gum repo is available). (confidence: 3)

## Completed Objectives
None

## Suggestions
[0] Configure and verify custom SMTP / sender settings for Firebase Authentication to ensure deliverability and institutional provenance. Actionable checklist: (1) choose SMTP provider (e.g., SendGrid, Mailgun, or institutional SMTP) and add credentials in Firebase Authentication SMTP settings; (2) set a custom 'From' address (institutional or project noreply) and update authorized domains to include the sender domain; (3) send and record test verification/password-reset emails (capture headers, DKIM/SPF results, and full delivery path); (4) document SMTP provider, credentials storage location (e.g., Secret Manager), test results, and the fallback plan in the IRB packet (include steps to revert if emails fail). (confidence: 6)
[1] Build an agent-driven automation / CLI scaffold to eliminate boilerplate DB setup: generate Firestore DB creation commands (gcloud or Terraform), restrictive security-rules templates with ownerUid patterns, SDK init snippets (client + server), .env template and .gitignore changes, a credential-rotation checklist, and an IRB checklist + slide skeleton. This would let Michael run one command to produce repo-ready infra/docs and a meeting-ready IRB packet. (confidence: 7)

## Notes
[0] Workspace evidence: unstaged local changes present (terminal shows 'modified: src/app/demo/page.tsx'); a local `.env.local` file with NEXT_PUBLIC_FB_* Firebase config (client API key and project identifiers) is in the repo root; terminal shows `npm i firebase` was recently run (firebase dependency installed). Useful context for repo-hygiene Next Steps (add .env.local to .gitignore, audit commits, rotate exposed keys). (confidence: 7)

## Project Resources
### Files
[0] macOS Numbers spreadsheet (context log) — visible in the user's session; appears to contain the project's context log / activity notes tied to the Firestore setup (file path unknown; likely local). (confidence: 3)
[1] autometrics-site/firebase.ts — TypeScript Firebase configuration file open in the editor (repo: autometrics-site). Appears to contain Firebase SDK initialization using environment variables (API key, project ID, project number, etc). Useful for reproducing client SDK initialization, verifying which env vars/keys are referenced, and adding secure initialization examples for docs/infra/firestore. (confidence: 6)
[2] autometrics-site/.env.local — local environment file in the autometrics-site repo containing client Firebase configuration variables (e.g., NEXT_PUBLIC_FB_API_KEY, NEXT_PUBLIC_FB_AUTH_DOMAIN, NEXT_PUBLIC_FB_PROJECT_ID). Visible in the screenshots and transcribed terminal/editor output; this exposes a client API key and confirms client-side config is being used for initialization. (Use this to drive the 'avoid committing secrets' checklist and to recommend rotating/restricting the key if necessary.) (confidence: 6)
[3] autometrics-site/package.json — Node project manifest for the autometrics-site frontend (visible in VS Code). Useful to confirm firebase is listed as a dependency, inspect build/test scripts, and capture commands to run (e.g., npm scripts) when creating reproducible integration steps or CI checks. (confidence: 6)
[4] GUM/db_utils.py — database utility module in the GeneralUserModels/gum repo (visible in the workspace). Potentially useful for Firestore/DB helper functions, migration scripts, or examples to adapt when creating reproducible automation and credential-handling code. (confidence: 4)
[5] src/app/demo/page.tsx — local frontend demo page with unstaged modifications (terminal shows 'modified: src/app/demo/page.tsx'). Important to track for demo preparation, code hygiene, and to include in commit/audit steps before rotating keys or publishing. (confidence: 7)
[6] GeneralUserModels/gum/README.md — repository README visible in the editor (uri guess: GeneralUserModels/gum/README.md). Useful high-level documentation site for the GUM repo and a logical place to store IRB packet drafts or pointers to infra/docs. (confidence: 3)
[7] Using firestore for session management — open editor note currently visible in the workspace; contains session-management guidance, Firestore rule snippets, and recommended client-side anonymous-auth patterns (uri unknown). Useful as a quick-reference and source for IRB packet/Next Steps. (confidence: 5)
[8] GeneralUserModels/gum/cli.py — Command-line helper module visible in the GUM repo tree (uri guess: GeneralUserModels/gum/cli.py). Likely contains automation/utility commands useful for running data-collection or repo tasks; include as a resource to reference when creating reproducible infra or scripts. (confidence: 3)
[9] GeneralUserModels/gum/models.py — model definitions file visible in the GUM repo tree (uri guess: GeneralUserModels/gum/models.py). Likely contains core data structures/schema useful for designing the Firestore sessions schema and for IRB documentation. (confidence: 3)
[10] .env (repo root) — repository-level environment file visible in the file tree (distinct from .env.local). Likely contains environment variables; relevant for secret/credential hygiene checks (audit, .gitignore, rotate leaked keys). URI guess: .env (confidence: 5)
[11] Institutional Review Board - Consent Form (Google Doc) — open consent-form currently being edited (contains study purpose, procedures, confidentiality, and active comments highlighting need to clarify public data release). Visible in the workspace; generic URL observed: https://docs.google.com. (confidence: 4)

### Repos
[0] autometrics-site — local frontend repository open in the editor/terminal (path: autometrics-site/). Contains firebase integration (autometrics-site/firebase.ts), the local .env.local with NEXT_PUBLIC_* Firebase config, and a modified demo page (src/app/demo/page.tsx). npm install firebase was recently run in this workspace. Useful as the primary place to update client/server initialization, add secure SDK snippets, and store demo/smoke-test code; consider saving infra/docs artifacts (infra/firestore or docs/firestore-setup) or the IRB packet here or in GeneralUserModels/gum. (confidence: 6)
[1] GeneralUserModels/gum — local repository/top-level workspace visible in file listing; candidate location to save IRB packet drafts, infra/firestore templates, and other project documentation (suggested path: GeneralUserModels/gum/docs/irb_packet or infra/firestore). Confirm availability before writing files. (confidence: 4)

### Folders
[0] background-agents/dev/survey — local survey subtree visible in the editor/file explorer containing context_log.csv, objective_inducer.py, logger/, screenshots/, swiftui-survey/, and survey_responses.csv. Useful for session-management examples, logs, and migration notes. (uri guess: background-agents/dev/survey/) (confidence: 3)

### Core Collaborators
None

### Other
[0] GCP project: SALTPersonal — Google Cloud Console (console.cloud.google.com). Firestore 'Create database' page currently open (Security rules: Restrictive; Location: Multi-region (nam5)). (confidence: 3)
[1] Firestore Studio (console) — Firestore web UI where the newly created database can be inspected and collections started/managed. (uri: https://console.cloud.google.com/firestore/data) (confidence: 3)
[2] Firestore pricing summary (console) — pricing panel that shows free quotas and cost implications for reads/writes; useful for IRB budgeting and cost/availability guidance. (uri: https://console.cloud.google.com/firestore/pricing) (confidence: 3)
[3] Firebase project: SALTPersonal — project ID `saltpersonal`, project number `895792146933`. Web API Key is present and visible in Project Settings (notably contradicts earlier note claiming no Web API Key). A Web app "autometrics-demo" is registered under Your apps. Billing: Blaze (pay-as-you-go). Useful to confirm when planning API-key restrictions, app registration steps, and which client config values are safe to expose vs. require server-side secrets. (confidence: 8)
[4] Firebase authentication email sender address observed: noreply@saltpersonal.firebaseapp.com (visible in Authentication -> Templates -> Email address verification). Useful to confirm for email delivery, authorized domains, and IRB notes about user-facing sender addresses. (confidence: 6)
[5] Firebase Authentication Templates console page: https://console.firebase.google.com/u/0/project/saltpersonal/authentication/emails — useful for capturing current email-template content, SMTP settings, sender address, and authorized-domain links for IRB and delivery troubleshooting. (confidence: 6)
[6] Google Cloud Storage buckets observed in Cloud Console: gs://autometrics-demo-storage (location: us) and gs://run-sources-saltpersonal-us-west1 (location: us-west1). Useful for storing session data, raw runs, and linking to Firebase Storage; include when planning storage rules, access controls, and cost estimates. (confidence: 6)
[7] SurveyApp (local): active survey UI where the user entered feedback about this project; visible response excerpt: "This is all annoying boilerplate work and it would really be nice if it could be done for me. The database setup etc." Useful evidence of user preference for automating DB/setup tasks and helpful for prioritizing automation/CLI work. (confidence: 6)
[8] Slack workspace: 'SALT' (visible in screenshot). Visible channels include '#stanford-gang' and '#subgroup-dialect-inclusive-nlp', and an open group DM thread is present. Useful for coordinating IRB review, recruiting reviewers, and saving conversation context for meeting prep and follow-ups. (source: current workspace screenshot) (confidence: 4)

## Next Steps
[0] Create reproducible integration artifacts for the Firestore setup: (1) a restrictive security rules template with example authenticated read/write exceptions for researcher/admin tools, (2) small SDK initialization snippets (Node.js and Python) showing secure connection patterns and least-privilege service-account usage, and (3) a reproducible automation snippet (gcloud command or Terraform fragment) that creates the Firestore DB with chosen location (nam5) and settings. Save these artifacts in the visible repo (GeneralUserModels/gum) under a new folder like `infra/firestore` or `docs/firestore-setup` (confirm exact location with the user). (confidence: 5)
[1] Draft IRB meeting packet (autonomous): produce a 5–8 slide deck skeleton (suggested slides: project overview, study design & data collection, participant protections & consent plan, data security & IRB considerations, current status/metrics, open questions, next steps), a one-page executive summary (objectives, methods, risks & mitigations, requested approvals), and a 3–5 minute speaking script. Use the macOS Numbers context log and captured Firestore settings as the source. Save drafts as markdown + speaker-notes files and, if the repo GeneralUserModels/gum is available, place them in docs/irb_packet (otherwise provide downloadable drafts). Link the produced files in the scratchpad once created. (confidence: 5)
[2] Enable Firestore backups & disaster recovery for SALTPersonal: turn on point-in-time recovery / scheduled backups, create at least one test backup and perform a restore to verify the procedure, configure backup retention policy, and add monitoring/alerts for failed backups and restore tests. Document the recovery steps and config in infra/firestore/backups.md (or repo location chosen by user). (confidence: 6)
[3] Register app(s) & provision scoped credentials for SALTPersonal: (1) register the required platform app(s) in Firebase (Web/iOS/Android) if client SDKs will be used; (2) prefer creating a dedicated service account for server-side ingestion with least-privilege IAM roles (avoid embedding long-lived service keys in clients); (3) if a client Web API key is needed, create it then restrict its usage by referrer/IP and enable only required APIs; (4) store server credentials in Google Secret Manager or environment variables and update autometrics-site/firebase.ts to read secrets securely (confirm it already uses env vars); (5) document the registration and credential-rotation process in infra/firestore/credentials.md (include commands and UI steps). (confidence: 7)
[4] Immediate remediation for client-exposed Firebase config: (1) Rotate the exposed client API key and restrict its usage in the Google Console (referrer/IP restrictions and limit allowed APIs). (2) Add autometrics-site/.env.local to .gitignore if not already ignored and confirm it is not committed; if it was committed, audit git history and rotate any leaked keys. (3) Move any admin/privileged credentials off client-side NEXT_PUBLIC_* vars: create a server-side service account with least-privilege IAM roles and store secrets in Google Secret Manager (or environment on the backend). (4) Update autometrics-site/firebase.ts to read only client-safe config from NEXT_PUBLIC_* and use a backend endpoint or Admin SDK for privileged operations. (5) Document the rotation/restriction and secret-storage steps in infra/firestore/credentials.md (or chosen repo location). (confidence: 6)
[5] Autonomously draft a short IRB data-sensitivity checklist and validation steps (markdown): - Purpose: 1-page checklist to bring to the IRB meeting verifying data-security posture for Firestore and client integration. - Contents (suggested): observed Firestore settings (location: nam5, security rules: Restrictive), required IRB notes (data types collected, de-identification plan, consent language pointers), encryption-at-rest/transfer note, IAM least-privilege checklist, key/secret management (rotate/restrict client API key, move admin creds to Secret Manager), backup & retention policy and restore test, access & audit logging plan, expected researcher/admin workflows and exception handling, and an explicit “Do NOT create DB until:” gate with items to confirm. - Deliverable: checklist markdown saved to GeneralUserModels/gum/docs/irb_packet/checklist.md (or if that repo isn't available, provide a downloadable markdown file). - Use sources: autometrics-site/.env.local, autometrics-site/firebase.ts, and the GCP/Firebase console observations. (confidence: 5)
[6] Draft a short, copy‑pasteable Slack message for the open SALT group DM about ARC / third‑party testing review: (a) 1–2 paragraph summary of the current conversation and context, (b) offer/request help reviewing the third‑party testing procedures, (c) propose concrete next steps with suggested owners and a rough timeline (e.g., who will read test procedures, who will attempt a quick reproducibility check, and a target due date), (d) include a 2–3 line thread summary for context and 1–2 suggested follow‑up questions to prompt resources or scheduling. Suggest saving the draft as markdown (suggested path: GeneralUserModels/gum/docs/slack_messages/arc_review.md) or as a local note for quick copy/paste. (confidence: 3)
[7] Draft Slack message (copy‑pasteable) for the open SALT group DM about ARC / third‑party testing review:

Message:
Hi all — quick context: ARC (third‑party) has asked for help reviewing their testing procedures to make sure their benchmarks and validation steps are reasonable and reproducible. They may share test plans, datasets, and resources and are looking for an informal academic/third‑party read. Could volunteers help with a short, lightweight review?

Proposed lightweight plan:
- Read & annotate the test procedures (2–3 hrs): note gaps, missing details, and ethical/IRB concerns. Owner: @REPLACE.
- Attempt a quick reproducibility smoke test on a small sample (4–8 hrs): run one or two core tests and report whether results are reproducible and what infra/data is needed. Owner: @REPLACE.
- Compile a 1–page findings summary and suggested follow‑ups (1–2 hrs). Owner/Coordinator: @REPLACE (I can coordinate if no one else volunteers).

Timeline suggestion: volunteers sign up by EOD this week; initial annotations + smoke test completed within 1 week; short summary circulated after that.

Thanks — if you can help, please reply with which role you can take (read / smoke test / summary) and your rough availability this week. I can coordinate signups and collect artifacts.

2–3 line thread summary (for context):
ARC reached out asking for an academic/third‑party review of their testing procedures. They can provide test plans and some resources; they’re looking for validation and possibly help reproducing a small run.

Suggested follow‑up questions to post in thread:
- Can ARC share the test procedure document + a small sample dataset/inputs we can use for a smoke run?
- Who can volunteer to do a 1–day reproducibility check this week?

Save draft as markdown: GeneralUserModels/gum/docs/slack_messages/arc_review.md (or paste directly into the open SALT DM). (confidence: 4)
[8] Autonomously draft explicit participant-facing consent wording clarifying planned public release of individual survey responses and chatbot interactions. Deliverable: a copy-pasteable consent paragraph for the IRB doc (plain-language description of what 'public release' means), a short technical note on anonymization and residual re-identification risk, a clear timeline and instructions for withdrawing before release, and a 3–4 item FAQ for likely participant questions. Paste the draft into the open Google Doc (Institutional Review Board - Consent Form) and copy the file into repo path GeneralUserModels/gum/docs/irb_packet/consent_public_release.md (if the repo is available). (confidence: 4)

## Agent Completed Tasks (Pending Review)
None

## Accepted Agent Completed Tasks
None

## Rejected Agent Completed Tasks
None